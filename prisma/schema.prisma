//ğŸ§©Don't Edit this file.âœ¨Generated in Mon Dec 16 2024 18:41:14 GMT+0800 (ä¸­å›½æ ‡å‡†æ—¶é—´)âœ¨

generator client {
  provider        = "prisma-client-js"
  previewFeatures = ["fullTextIndex"]
}

datasource db {
  provider = "mongodb"
  url      = env("DATABASE_URL")
}

model ReXAppStore {
  productID    String   @id @default(auto()) @map("_id") @db.ObjectId
  createdAt    DateTime @default(now())
  updatedAt    DateTime @updatedAt
  /// appåç§°
  productName  String
  /// appæè¿°
  productDesc  String
  /// appä¸‹è½½åœ°å€
  downloadUrl  String
  /// appä¸‹è½½æ¬¡æ•°
  downloadNum  Int      @default(0)
  /// appä¸‹è½½åœ°å€é™„åŠ ä¿¡æ¯
  downloadInfo String
  /// appå›¾æ ‡
  iconUrl      String?
  /// appç‰ˆæœ¬
  version      String?
  /// appå¤§å°
  size         String?
  /// appä½œè€…
  author       String?
  /// appä¸Šä¼ è€…
  uploader     User     @relation(fields: [userID], references: [userID])
  /// appä¸Šä¼ è€…ID
  userID       String   @db.ObjectId
}

model Like {
  likeID         String             @id @default(auto()) @map("_id") @db.ObjectId
  createdAt      DateTime           @default(now())
  updatedAt      DateTime           @updatedAt
  /// ç”¨æˆ·
  user           User               @relation(fields: [userID], references: [userID])
  /// ç”¨æˆ·ID
  userID         String             @db.ObjectId
  /// ç‚¹èµçš„å¸–å­
  topic          ForumTopic?        @relation(fields: [topicID], references: [topicID])
  /// å¸–å­ID
  topicID        String?            @db.ObjectId
  /// ç‚¹èµçš„è¯„è®º
  topicComment   ForumTopicComment? @relation(fields: [topicCommentID], references: [forumTopicCommentID])
  /// ç‚¹èµçš„è¯„è®ºID
  topicCommentID String?            @db.ObjectId
}

model Tag {
  tagID                 String               @id @default(auto()) @map("_id") @db.ObjectId
  createdAt             DateTime             @default(now())
  updatedAt             DateTime             @updatedAt
  /// æ ‡ç­¾å
  tagName               String               @unique
  /// æ ‡ç­¾æè¿°
  tagDescription        String?
  /// æ ‡ç­¾æµè§ˆé‡
  tagViewCount          Int                  @default(0)
  /// é“¾æ¥çš„è„šæœ¬
  browserScriptStore    BrowserScriptStore[] @relation(fields: [browserScriptStoreIDs], references: [browserScriptStoreID])
  /// é“¾æ¥çš„è„šæœ¬ID
  browserScriptStoreIDs String[]             @db.ObjectId
  /// è®ºå›è¯é¢˜
  forumTopic            ForumTopic[]         @relation(fields: [forumTopicIDs], references: [topicID])
  /// è®ºå›è¯é¢˜ID
  forumTopicIDs         String[]             @db.ObjectId

  @@fulltext([tagName, tagDescription])
}

model ForumTopicComment {
  /// è¯„è®ºID
  forumTopicCommentID String              @id @default(auto()) @map("_id") @db.ObjectId
  /// åˆ›å»ºæ—¶é—´
  createdAt           DateTime            @default(now())
  /// æ›´æ–°æ—¶é—´
  updatedAt           DateTime            @updatedAt
  /// è¯„è®ºå†…å®¹ æ”¯æŒmarkdown
  content             String
  /// topicä½œè€…
  author              User                @relation(fields: [authorID], references: [userID])
  /// ä½œè€…ID
  authorID            String              @db.ObjectId
  /// ç‚¹èµ
  likes               Like[]
  /// çˆ¶è¯„è®º
  parent              ForumTopicComment?  @relation("ForumTopicCommentToForumTopicComment", fields: [parentID], references: [forumTopicCommentID], onDelete: NoAction, onUpdate: NoAction)
  /// çˆ¶è¯„è®ºID
  parentID            String?             @db.ObjectId
  /// å­è¯„è®º
  children            ForumTopicComment[] @relation("ForumTopicCommentToForumTopicComment")
  /// è¯é¢˜
  topic               ForumTopic          @relation(fields: [topicID], references: [topicID])
  /// è¯é¢˜ID
  topicID             String              @db.ObjectId
  /// IP
  ip                  String?

  @@fulltext([content])
}

model ForumTopic {
  /// è¯é¢˜ID
  topicID           String              @id @default(auto()) @map("_id") @db.ObjectId
  /// åˆ›å»ºæ—¶é—´
  createdAt         DateTime            @default(now())
  /// æ›´æ–°æ—¶é—´
  updatedAt         DateTime            @updatedAt
  /// è¯é¢˜åç§°
  topicName         String?
  /// è¯é¢˜æè¿°
  topicDesc         String?
  /// è¯é¢˜å†…å®¹ æ”¯æŒmarkdown
  topicContent      String?
  /// topicä½œè€…
  author            User                @relation(fields: [authorID], references: [userID])
  /// ä½œè€…ID
  authorID          String              @db.ObjectId
  /// è¯é¢˜çŠ¶æ€
  status            ForumTopicStatus
  /// è¯é¢˜æ ‡ç­¾
  tags              Tag[]               @relation(fields: [tagIDs], references: [tagID])
  /// æ ‡ç­¾ID
  tagIDs            String[]            @db.ObjectId
  /// è¯é¢˜æµè§ˆé‡
  viewCount         Int                 @default(0)
  /// è¯é¢˜å±•ç°é‡
  displayCount      Int                 @default(0)
  /// è¯é¢˜ç‚¹èµ
  likes             Like[]
  /// è¯é¢˜è¯„è®º
  ForumTopicComment ForumTopicComment[]

  @@fulltext([topicName, topicDesc, topicContent])
}

/// é—ªç”µï¼šç”¨æˆ·App Storeè®¢é˜…
model UserAppStoreSubscribe {
  userAppStoreSubscribeID String   @id @default(auto()) @map("_id") @db.ObjectId
  createdAt               DateTime @default(now())
  updatedAt               DateTime @updatedAt
  /// åŸå§‹äº¤æ˜“ID
  originalTransactionID   String

  user   User   @relation(fields: [userID], references: [userID])
  userID String @db.ObjectId

  /// æ·»åŠ ç´¢å¼•
  @@index([userID])
}

/// é—ªç”µï¼šæµè§ˆå™¨ä¹¦ç­¾
model BrowserBookMark {
  browserBookMarkID String   @id @default(auto()) @map("_id") @db.ObjectId
  createdAt         DateTime @default(now())
  updatedAt         DateTime @updatedAt
  /// æ ‡é¢˜
  bookMarkTitle     String
  /// é“¾æ¥
  bookMarkLink      String
  /// å›¾æ ‡
  bookMarkIcon      String
  /// é¢œè‰²
  bookMarkColor     String
  /// ç´¢å¼•
  bookMarkIndex     Int
  /// ç”¨æˆ·
  user              User     @relation(fields: [userID], references: [userID])
  /// ç”¨æˆ·ID
  userID            String   @db.ObjectId

  /// æ·»åŠ ç´¢å¼•
  @@index([userID])
}

/// é—ªç”µï¼šæµè§ˆå™¨è„šæœ¬
model BrowserScript {
  browserScriptID String   @id @default(auto()) @map("_id") @db.ObjectId
  createdAt       DateTime @default(now())
  updatedAt       DateTime @updatedAt
  /// è„šæœ¬
  scriptContent   String
  /// è„šæœ¬è§£æåçš„å†…å®¹
  scriptInfo      String
  /// ä¸Šä¼ çš„ç”¨æˆ·
  user            User     @relation(fields: [userID], references: [userID])
  /// ä¸Šä¼ çš„ç”¨æˆ·ID
  userID          String   @db.ObjectId
}

/// é—ªç”µï¼šæµè§ˆå™¨è„šæœ¬åº“
model BrowserScriptStore {
  browserScriptStoreID String       @id @default(auto()) @map("_id") @db.ObjectId
  createdAt            DateTime     @default(now())
  updatedAt            DateTime     @updatedAt
  /// è„šæœ¬
  scriptContent        String
  /// è„šæœ¬è§£æåçš„å†…å®¹
  scriptInfo           String
  /// æµè§ˆé‡
  viewCount            Int
  scriptStatus         ScriptStatus
  /// ä¸Šä¼ è€…
  uploader             User         @relation(fields: [uploaderUserID], references: [userID])
  /// ä¸Šä¼ è€…ID
  uploaderUserID       String       @db.ObjectId
  /// æ ‡ç­¾
  tags                 Tag[]        @relation(fields: [tagIDs], references: [tagID])
  tagIDs               String[]     @db.ObjectId
}

/// é—ªç”µï¼šæµè§ˆå™¨è¶³è¿¹
model BrowserTrack {
  browserTrackID String   @id @default(auto()) @map("_id") @db.ObjectId
  createdAt      DateTime @default(now())
  updatedAt      DateTime @updatedAt
  /// æ ‡é¢˜
  webPageTitle   String
  /// é“¾æ¥
  webPageLink    String
  /// ç”¨æˆ·
  user           User     @relation(fields: [userID], references: [userID])
  /// ç”¨æˆ·ID
  userID         String   @db.ObjectId

  @@index([userID])
}

model ShopSubscribePackage {
  /// å¥—é¤ID
  packageID    String          @id @default(auto()) @map("_id") @db.ObjectId
  /// åˆ›å»ºæ—¶é—´
  createdAt    DateTime        @default(now())
  /// æ›´æ–°æ—¶é—´
  updatedAt    DateTime        @updatedAt
  /// å¥—é¤åç§°
  name         String
  /// å¥—é¤æè¿°
  description  String
  /// å¥—é¤ä»·æ ¼ RMB
  price        Float
  /// å¥—é¤å¤©æ•°
  days         Int
  /// å¥—é¤åˆ›å»ºè€…
  author       User            @relation(fields: [authorID], references: [userID])
  /// å¥—é¤åˆ›å»ºè€…ID
  authorID     String          @db.ObjectId
  /// å¥—é¤æ˜¯å¦ä¸Šæ¶
  isOnSale     Boolean         @default(true)
  /// å¥—é¤ä¸‹çš„è®¢é˜…
  GPTSubscribe ShopSubscribe[]
}

model ShopSubscribe {
  /// è¯„è®ºID
  subscribeID    String               @id @default(auto()) @map("_id") @db.ObjectId
  /// åˆ›å»ºæ—¶é—´
  createdAt      DateTime             @default(now())
  /// æ›´æ–°æ—¶é—´
  updatedAt      DateTime             @updatedAt
  /// ç”¨æˆ·
  user           User                 @relation(fields: [userID], references: [userID])
  /// ç”¨æˆ·ID
  userID         String               @db.ObjectId
  /// åˆ°æœŸå¤©æ•°
  days           Int
  /// å¥—é¤
  package        ShopSubscribePackage @relation(fields: [packageID], references: [packageID])
  /// å¥—é¤ID
  packageID      String               @db.ObjectId
  /// æ˜¯å¦æ‰‹åŠ¨åˆ›å»ºçš„è®¢é˜…
  isManualCreate Boolean              @default(false)
}

model UserData {
  userDataID String   @id @default(auto()) @map("_id") @db.ObjectId
  createdAt  DateTime @default(now())
  updatedAt  DateTime @updatedAt

  userDataKey   String @unique
  userDataValue String

  user   User   @relation(fields: [userID], references: [userID])
  userID String @db.ObjectId
}

/// ç”¨æˆ·ç™»å½•æ ‡è¯†ç¬¦
model UserIdentifier {
  userIdentifierID String       @id @default(auto()) @map("_id") @db.ObjectId
  createdAt        DateTime     @default(now())
  updatedAt        DateTime     @updatedAt
  /// ç™»å½•è®¾å¤‡ç±»å‹
  loginType        ILoginType
  /// ç™»å½•çš„å®¢æˆ·ç«¯ æ˜¯å“ªä¸ªAPP
  loginClient      String?
  /// ç™»å½•çš„è®¾å¤‡å
  loginDeviceName  String?
  /// ç™»å½•çš„IP
  loginIP          String?
  /// ç™»å½•çš„æ¸ é“
  loginMethod      ILoginMethod
  /// ç™»å½•çš„æ ‡è¯†ç¬¦
  identifier       String?
  /// ç™»å½•çš„ç”¨æˆ·
  user             User         @relation(fields: [userID], references: [userID])
  /// ç™»å½•çš„ç”¨æˆ·ID
  userID           String       @db.ObjectId
}

model UserReceipt {
  userReceiptID String         @id @default(auto()) @map("_id") @db.ObjectId
  createdAt     DateTime       @default(now())
  updatedAt     DateTime       @updatedAt
  // è®¢å•ID
  orderID       String
  /// è®¢å•é‡‘é¢ å•ä½å…ƒ ä¿ç•™ä¸¤ä½å°æ•°
  amount        Float
  /// ç”¨æˆ·
  user          User           @relation(fields: [userID], references: [userID])
  /// ç”¨æˆ·ID
  userID        String         @db.ObjectId
  /// è®¢å•çŠ¶æ€
  receiptStatus IReceiptStatus
  /// è®¢å•ç±»å‹
  payType       String
  /// éšæœºå­—ç¬¦ä¸² ç”¨äºé‰´å®š
  nonceStr      String?
}

/// è§’è‰²
model Role {
  roleID          String   @id @default(auto()) @map("_id") @db.ObjectId
  createdAt       DateTime @default(now())
  updatedAt       DateTime @updatedAt
  /// è§’è‰²çš„åç§°
  roleName        String   @unique
  /// è§’è‰²çš„æè¿°
  roleDescription String?
  /// è§’è‰²æ˜¯å¦å…¬å¼€
  isPublic        Boolean
  /// è§’è‰²çš„æƒé™
  permissions     String[]
  /// è§’è‰²æ˜¯å¦æ³¨å†Œå³äº«æœ‰
  isDefault       Boolean?
  /// è§’è‰²çš„æƒé™ID
  permissionIDs   String[] @db.ObjectId
  /// è§’è‰²çš„ç”¨æˆ·
  users           User[]   @relation(fields: [userIDs], references: [userID])
  /// è§’è‰²çš„ç”¨æˆ·ID
  userIDs         String[] @db.ObjectId
}

/// ç”¨æˆ·
model User {
  userID                String                  @id @default(auto()) @map("_id") @db.ObjectId
  createdAt             DateTime                @default(now())
  updatedAt             DateTime                @updatedAt
  /// ç”¨æˆ·çš„ç”¨æˆ·å
  username              String
  /// ç”¨æˆ·çš„å¯†ç 
  password              String?
  /// ç”¨æˆ·çš„ip
  ip                    String?
  /// ç”¨æˆ·çš„æ˜µç§°
  saying                String?
  /// ç”¨æˆ·çš„å¤´åƒ
  avatar                String?
  /// ç”¨æˆ·çš„é‚®ç®±
  email                 String?
  /// ç”¨æˆ·çš„æ‰‹æœºå·
  phone                 String?
  /// ç”¨æˆ·æ˜¯å¦è¢«åˆ é™¤
  isDeleted             Boolean?                @default(false)
  /// ç”¨æˆ·ä½™é¢
  balance               Float?
  /// ç”¨æˆ·ç»‘å®šçš„å¾®è½¯è´¦å· - æ ‡è¯†ç¬¦
  microsoftID           String?
  /// ç”¨æˆ·çš„ç™»å½•æ ‡è¯†ç¬¦
  identifiers           UserIdentifier[]
  /// ç”¨æˆ·çš„æµè§ˆå™¨ä¹¦ç­¾
  BrowserBookMark       BrowserBookMark[]
  /// ç”¨æˆ·çš„æµè§ˆå™¨è¶³è¿¹
  BrowserTrack          BrowserTrack[]
  /// ç”¨æˆ·çš„App Storeè®¢é˜…
  UserAppStoreSubscribe UserAppStoreSubscribe[]
  /// ç”¨æˆ·çš„è§’è‰²
  roles                 Role[]                  @relation(fields: [roleIDs], references: [roleID])
  /// ç”¨æˆ·çš„è§’è‰²ID
  roleIDs               String[]                @db.ObjectId
  /// ç”¨æˆ·çš„æµè§ˆå™¨è„šæœ¬
  BrowserScript         BrowserScript[]
  /// ç”¨æˆ·åœ¨å•†åº—åˆ›å»ºçš„æµè§ˆå™¨è„šæœ¬
  BrowserScriptStore    BrowserScriptStore[]
  /// ç”¨æˆ·çš„æ•°æ®
  UserData              UserData[]
  /// ç”¨æˆ·çš„æ”¯ä»˜æ”¶æ®
  UserReceipt           UserReceipt[]
  /// ç”¨æˆ·çš„å¸–å­
  forumTopics           ForumTopic[]
  /// ç”¨æˆ·çš„å¸–å­è¯„è®º
  forumTopicComments    ForumTopicComment[]
  /// ç”¨æˆ·çš„ç‚¹èµ
  likes                 Like[]
  /// ç”¨æˆ·çš„ReX App Storeä¸Šä¼ è®°å½•
  AppStore              ReXAppStore[]
  /// ç”¨æˆ·çš„è®¢é˜…
  ShopSubscribe         ShopSubscribe[]
  /// ç”¨æˆ·åˆ›å»ºçš„è®¢é˜…
  ShopSubscribePackage  ShopSubscribePackage[]

  @@fulltext([username])
}

enum ScriptStatus {
  Pending
  Draft
  Published
}

enum ForumTopicStatus {
  Pending
  Draft
  Published
}

/// ç™»å½•è®¾å¤‡ç±»å‹
enum ILoginType {
  WatchOS
  HarmonyOS_Wearable
  Android
  Web
  IOS
  Panel
}

/// ç™»å½•æ–¹å¼
enum ILoginMethod {
  QrCode
  PhoneCode
  EmailCode
  UsernamePassword
  Microsoft
}

enum IReceiptStatus {
  Pending
  Success
  Failed
}
